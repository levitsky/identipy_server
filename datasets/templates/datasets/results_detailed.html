{% extends "base.html" %}
{% block title %}Search results: {{ searchrun.searchgroup_parent.groupname }}/{{ searchrun.name}}{% endblock%}
{% block content %}
{% load stringfilter %}
        <form action="" method="post">{% csrf_token %}
        <div id="tab">
        <form action="" method="post">{% csrf_token %}
            <h2>
        <p>Search results: <input type="submit" class="link" value = {{ searchrun.searchgroup_parent.groupname }} name="search_details">/<input type="submit" class="link" value={{ searchrun.name|spacify }} name="results_figure"/>
        <input type="hidden" name="results_figure_actualname" value={{ searchrun.runname|spacify }}>
        <input type="hidden" name="results_figure_searchgroupid" value={{ searchrun.searchgroup_parent.id }}></p>
            
				{% if searchgroup %}
            <table id="processes_list" type="bordered">
                <tr id="headings">
                    <th>Search name</th>
                    <th>PSMs</th>
                    <th>Peptides</th>
                    <th>Proteins</th>
                    <th>PSM FDR</th>
                    <th>Protein FDR</th>
                    <th>MS/MS</th>
                    <th>Unfiltered PSMs</th>
                    
                    
                </tr>
            <tr>
            <td class="td1">{{ searchrun.name|spacify }}</td>
            <td class="td2"><input type="submit" class="link" value={{ searchrun.numPSMs }} name="show_psms"></td>
            <td class="td2"><input type="submit" class="link" value={{ searchrun.numPeptides }} name="show_peptides"></td>
            <td class="td2"><input type="submit" class="link" value={{ searchrun.numProteins }} name="show_proteins"></td>
            <td class="td2">{{ searchrun.fdr_psms }}</td>
            <td class="td2">{{ searchrun.get_prots_FDR }}</td>
            <td class="td2">{{ searchrun.numMSMS }}</td>
            <td class="td2">{{ searchrun.totalPSMs }}</td>
            </tr>
            </table></h2>
		{% else %}
			<p>There are no searches</p>
		{% endif %}

          <h4>      {% if results_detailed %}
           
        <table width="100%"><tr><td width="80%"> 
            {{ results_detailed.labelform.as_p }}</td>
            <td align="right"><input type="submit" class="btn" value="show selected columns" name="select_labels"></td></tr></table>
            </h4>
            <h2><div class="scroll short"> 
            <table id="processes_list" type="bordered">
                <tr id="headings">
			        {% for label in results_detailed.get_labels %}
                    <th><input type="submit" class="link" value={{ label|spacify }} name=order_by></th>
			        {% endfor %}
                </tr>
            {% for prot in results_detailed.get_values %}
                <tr>
                {% for val in prot %}
                <td class="td2">{{ val }}</td>
                {% endfor %}
                </tr>
            {% endfor %}
                </table></div>
		{% else %}
			<p>There are no searches</p>
		{% endif %}

        <div id="get_status">
        <input type="submit" class="link" value="download as csv" name="download_custom_csv"/>
        <input type="hidden" name="results_figure_actualname" value={{ searchrun.runname|spacify }}>
        <input type="hidden" name="results_figure_searchgroupid" value={{ searchrun.searchgroup_parent.id }}>
        
        </div>
            </h2>
        
</form></div>
{% endblock %}
